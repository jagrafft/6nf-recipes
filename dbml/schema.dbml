// Project
Project observable_bakers_percentages {
  database_type: "Postgres"
  Note: "Schema for database used by https://observablehq.com/@jagrafft/bakers-percentage-calculator"
}

// Tables
Table data_authors [headercolor: #946fc7] {
  id INT [pk]
  author TEXT [not null, unique]
}

Table data_dates [headercolor: #946fc7] {
  id INT [pk]
  dte DATE [not null, unique]
}

Table data_ingredients [headercolor: #946fc7] {
  id INT [pk]
  ingredient TEXT [not null, unique]
}

Table data_default_masses [headercolor: #946fc7] {
  id INT [pk]
  grams REAL [not null, unique]
}

Table data_ratios [headercolor: #946fc7] {
  id INT [pk]
  ratio REAL [not null, unique]
}

Table data_titles [headercolor: #946fc7] {
  id INT [pk]
  title TEXT [not null, unique]
}

TableGroup datum {
  data_authors
  data_dates
  data_default_masses
  data_ingredients
  data_ratios
  data_titles
  recipe_urls
}

Table recipe_access_dates [headercolor: #7aa444] {
  url_id INT [pk]
  date_id INT [not null]
  
  indexes {
    (url_id, date_id) [unique]
  }
}
Ref: recipe_access_dates.url_id - recipe_urls.id
Ref: recipe_access_dates.date_id - data_dates.id

Table recipe_authors [headercolor: #7aa444] {
  url_id INT [pk]
  author_id INT [not null]
  
  indexes {
    (url_id, author_id) [unique]
  }
}
Ref: recipe_authors.url_id > recipe_urls.id
Ref: recipe_authors.author_id > data_authors.id

Table recipe_citation_title [headercolor: #7aa444] {
  url_id INT [pk]
  title_id INT [not null]
  
  indexes {
    (url_id, title_id) [unique]
  }
}
Ref: recipe_citation_title.url_id - recipe_urls.id
Ref: recipe_citation_title.title_id - data_titles.id

Table recipe_dates [headercolor: #7aa444] {
  url_id INT [pk]
  date_id INT [not null]
  
  indexes {
    (url_id, date_id) [unique]
  }
}
Ref: recipe_dates.url_id - recipe_urls.id
Ref: recipe_dates.date_id - data_dates.id

Table recipe_default_masses [headercolor: #7aa444] {
  url_id INT [pk]
  grams_id INT [not null]
  
  indexes {
    (url_id, grams_id) [unique]
  }
}
Ref: recipe_default_masses.url_id - recipe_urls.id
Ref: recipe_default_masses.grams_id - data_default_masses.id

Table recipe_ingredients [headercolor: #7aa444] {
  url_id INT [pk]
  ingredients_id INT [not null]
  
  indexes {
    (url_id, ingredients_id) [unique]
  }
}
Ref: recipe_ingredients.url_id > recipe_urls.id
Ref: recipe_ingredients.ingredients_id > data_ingredients.id

Table recipe_ratios [headercolor: #7aa444] {
  url_id INT [pk]
  ingredients_id INT [not null]
  ratio_id INT [not null]
  
  indexes {
    (url_id, ingredients_id, ratio_id) [unique]
  }
}
Ref: recipe_ratios.url_id > recipe_urls.id
Ref: recipe_ratios.ratio_id > data_ratios.id
Ref: recipe_ratios.ingredients_id > data_ingredients.id

Table recipe_titles [headercolor: #7aa444] {
  url_id INT [pk]
  title_id INT [not null]
  
  indexes {
    (url_id, title_id) [unique]
  }
}
Ref: recipe_titles.url_id - recipe_urls.id
Ref: recipe_titles.title_id - data_titles.id

Table recipe_urls [headercolor: #7aa444] {
  id INT [pk]
  url TEXT [not null, unique]
  Note: "URLs are used as globally unique identifiers for recipes"
}

TableGroup recipes {
  recipe_access_dates
  recipe_authors
  recipe_citation_title
  recipe_dates
  recipe_default_masses
  recipe_ingredients
  recipe_ratios
  recipe_titles
}